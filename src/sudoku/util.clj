(ns sudoku.util)

(def boxart-fmt
"┏━━━━━┯━━━━━┯━━━━━┳━━━━━┯━━━━━┯━━━━━┳━━━━━┯━━━━━┯━━━━━┓
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┨
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┨
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┣━━━━━┿━━━━━┿━━━━━╋━━━━━┿━━━━━┿━━━━━╋━━━━━┿━━━━━┿━━━━━┫
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┨
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┨
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┣━━━━━┿━━━━━┿━━━━━╋━━━━━┿━━━━━┿━━━━━╋━━━━━┿━━━━━┿━━━━━┫
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┫
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┠─────┼─────┼─────╂─────┼─────┼─────╂─────┼─────┼─────┨
┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃%3c  │%3c  │%3c  ┃
┗━━━━━┷━━━━━┷━━━━━┻━━━━━┷━━━━━┷━━━━━┻━━━━━┷━━━━━┷━━━━━┛")
(def boxart-fmt2
  "┏━━━┯━━━┯━━━┳━━━┯━━━┯━━━┳━━━┯━━━┯━━━┓
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┨
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┨
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┣━━━┿━━━┿━━━╋━━━┿━━━┿━━━╋━━━┿━━━┿━━━┫
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┨
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┨
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┣━━━┿━━━┿━━━╋━━━┿━━━┿━━━╋━━━┿━━━┿━━━┫
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┫
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┠───┼───┼───╂───┼───┼───╂───┼───┼───┨
┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃ %c │ %c │ %c ┃
┗━━━┷━━━┷━━━┻━━━┷━━━┷━━━┻━━━┷━━━┷━━━┛")

(defn boxart
  "Pretty-print a sudoku using box-art characters. Not suitable for all displays.
  For environments such as IntelliJ that enforce some vertical whitespace between
  lines, {:widen true} gives the best results. For displays such as terminals that
  have excellent support for boxart, {:widen false} (the default) looks best."
  ([sudoku]
   (boxart sudoku {:widen false}))
  ([sudoku opts]
   (when sudoku
     (let [fmt (if (:widen opts)
                 boxart-fmt
                 boxart-fmt2)]
       (apply format fmt (map #(if (zero? %) \  (first (str %))) sudoku))))))